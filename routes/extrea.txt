const UploadFile=()=>{

    const uploadassignment = upload.single("file");
    uploadassignment(req, res, async (err) => {


        //if error uploading file
        if (err) {
            return res.send({ message: err.message })
        }

        //if no error them create assignment
        if (req.file === undefined) {
            return res.send("no file is attached")
        }

        const file = req.file.filename;


        const errors = validationResult(req);
        const { courseid, description, title, submissiondate } = req.body;
        const check = await topicmodel.findById(topicid);

        if (!check) {
            res.send({ success: false, msg: "No Topic found against this id" })

        }


        if (errors.isEmpty()) {



            try {

                await topicmodel.findByIdAndUpdate(topicid, {
                    $push:
                    {
                        assignments:
                        {
                            course: courseid,
                            title: title,
                            description: description,
                            filename: file,
                            submissiondate: submissiondate
                        }
                    }
                });
                const data = await topicmodel.findById(topicid);

                res.send({ success: true, msg: "Assignment Created for the given topic", details: data })


                // console.log(data);

            } catch (error) {
                console.log("create assignment error  " + error);
                res.send("some error occureed try again ")
            }
        } else {
            res.send(errors);

        }


    });

}
